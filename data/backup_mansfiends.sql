--
-- Script was generated by Devart dbForge Studio 2022 for MySQL, Version 9.1.21.0
-- Product home page: http://www.devart.com/dbforge/mysql/studio
-- Script date 20.06.2023 23:01:05
-- Server version: 8.0.32
-- Client version: 4.1
--

-- 
-- Disable foreign keys
-- 
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;

-- 
-- Set SQL mode
-- 
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;

-- 
-- Set character set the client will use to send SQL statements to the server
--
SET NAMES 'utf8';

--
-- Set default database
--
USE mansfriends;

--
-- Drop view `commandsanimal`
--
DROP VIEW IF EXISTS commandsanimal CASCADE;

--
-- Drop table `commandstype`
--
DROP TABLE IF EXISTS commandstype;

--
-- Drop table `commands`
--
DROP TABLE IF EXISTS commands;

--
-- Drop view `fullanimal`
--
DROP VIEW IF EXISTS fullanimal CASCADE;

--
-- Drop view `yanimals`
--
DROP VIEW IF EXISTS yanimals CASCADE;

--
-- Drop view `younganimals`
--
DROP VIEW IF EXISTS younganimals CASCADE;

--
-- Drop table `animals`
--
DROP TABLE IF EXISTS animals;

--
-- Drop table `typeanimals`
--
DROP TABLE IF EXISTS typeanimals;

--
-- Drop table `usinganimals`
--
DROP TABLE IF EXISTS usinganimals;

--
-- Set default database
--
USE mansfriends;

--
-- Create table `usinganimals`
--
CREATE TABLE usinganimals (
  idUsingAnimal int NOT NULL AUTO_INCREMENT,
  usingAnimal varchar(45) DEFAULT NULL,
  PRIMARY KEY (idUsingAnimal)
)
ENGINE = INNODB,
AUTO_INCREMENT = 3,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci;

--
-- Create table `typeanimals`
--
CREATE TABLE typeanimals (
  idtypeAnimal int NOT NULL AUTO_INCREMENT,
  typeAnimal varchar(45) DEFAULT NULL,
  idUsingAnimal int DEFAULT NULL,
  PRIMARY KEY (idtypeAnimal)
)
ENGINE = INNODB,
AUTO_INCREMENT = 7,
AVG_ROW_LENGTH = 2730,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci;

--
-- Create foreign key
--
ALTER TABLE typeanimals
ADD CONSTRAINT FK_typeanimals_usinganimals_idUsingAnimal FOREIGN KEY (idUsingAnimal)
REFERENCES usinganimals (idUsingAnimal);

--
-- Create table `animals`
--
CREATE TABLE animals (
  idanimal int NOT NULL AUTO_INCREMENT,
  nameAnimal varchar(50) NOT NULL,
  idTypeAnimal int NOT NULL,
  dateOfBirth date DEFAULT NULL,
  PRIMARY KEY (idanimal)
)
ENGINE = INNODB,
AUTO_INCREMENT = 7,
AVG_ROW_LENGTH = 2730,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Животные';

--
-- Create foreign key
--
ALTER TABLE animals
ADD CONSTRAINT FK_animals_typeanimals_idtypeAnimal FOREIGN KEY (idTypeAnimal)
REFERENCES typeanimals (idtypeAnimal);

--
-- Create view `younganimals`
--
CREATE
DEFINER = 'root'@'localhost'
VIEW younganimals
AS
SELECT
  `animals`.`idanimal` AS `idanimal`,
  `animals`.`nameAnimal` AS `nameAnimal`,
  `animals`.`idTypeAnimal` AS `idTypeAnimal`,
  `animals`.`dateOfBirth` AS `dateOfBirth`
FROM `animals`
WHERE (`animals`.`dateOfBirth` BETWEEN (CURDATE() - INTERVAL 3 year) AND (CURDATE() - INTERVAL 1 year));

--
-- Create view `yanimals`
--
CREATE
DEFINER = 'yn'@'%'
VIEW yanimals
AS
SELECT
  `a`.`idanimal` AS `idanimal`,
  `a`.`nameAnimal` AS `nameAnimal`,
  `t`.`typeAnimal` AS `typeAnimal`,
  `u`.`usingAnimal` AS `usingAnimal`,
  `a`.`dateOfBirth` AS `dateOfBirth`
FROM ((`animals` `a`
  JOIN `typeanimals` `t`
    ON ((`a`.`idTypeAnimal` = `t`.`idtypeAnimal`)))
  JOIN `usinganimals` `u`
    ON ((`t`.`idUsingAnimal` = `u`.`idUsingAnimal`)))
WHERE (`a`.`dateOfBirth` BETWEEN (CURDATE() - INTERVAL 3 year) AND (CURDATE() - INTERVAL 1 year));

--
-- Create view `fullanimal`
--
CREATE
DEFINER = 'yn'@'%'
SQL SECURITY INVOKER
VIEW fullanimal
AS
SELECT
  `animals`.`idanimal` AS `idanimal`,
  `animals`.`nameAnimal` AS `nameAnimal`,
  `typeanimals`.`typeAnimal` AS `TypeAnimal`,
  `usinganimals`.`usingAnimal` AS `isingAnimal`,
  `animals`.`dateOfBirth` AS `dateOfBirth`
FROM ((`animals`
  JOIN `typeanimals`
    ON ((`animals`.`idTypeAnimal` = `typeanimals`.`idtypeAnimal`)))
  JOIN `usinganimals`
    ON ((`typeanimals`.`idUsingAnimal` = `usinganimals`.`idUsingAnimal`)))
ORDER BY `animals`.`idanimal`;

--
-- Create table `commands`
--
CREATE TABLE commands (
  idCommand int NOT NULL AUTO_INCREMENT,
  command varchar(45) DEFAULT NULL,
  PRIMARY KEY (idCommand)
)
ENGINE = INNODB,
AUTO_INCREMENT = 6,
AVG_ROW_LENGTH = 3276,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Типы животных';

--
-- Create table `commandstype`
--
CREATE TABLE commandstype (
  idcommand int NOT NULL,
  idTypeAnimals int NOT NULL,
  answer varchar(45) DEFAULT NULL,
  PRIMARY KEY (idcommand, idTypeAnimals)
)
ENGINE = INNODB,
AVG_ROW_LENGTH = 712,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Команды, выполняемые типами животных';

--
-- Create foreign key
--
ALTER TABLE commandstype
ADD CONSTRAINT FK_commandstype_commands_idCommand FOREIGN KEY (idTypeAnimals)
REFERENCES commands (idCommand);

--
-- Create foreign key
--
ALTER TABLE commandstype
ADD CONSTRAINT FK_commandstype_typeanimals_idtypeAnimal FOREIGN KEY (idTypeAnimals)
REFERENCES typeanimals (idtypeAnimal);

--
-- Create view `commandsanimal`
--
CREATE
DEFINER = 'yn'@'%'
VIEW commandsanimal
AS
SELECT
  `commands`.`command` AS `command`,
  `animals`.`idanimal` AS `idanimal`
FROM (((`animals`
  JOIN `typeanimals`
    ON ((`animals`.`idTypeAnimal` = `typeanimals`.`idtypeAnimal`)))
  JOIN `commandstype`
    ON ((`typeanimals`.`idtypeAnimal` = `commandstype`.`idTypeAnimals`)))
  JOIN `commands`
    ON ((`commands`.`idCommand` = `commandstype`.`idcommand`)))
ORDER BY `commands`.`command`;

-- 
-- Dumping data for table usinganimals
--
INSERT INTO usinganimals VALUES
(1, 'Домашнее животное'),
(2, 'Вьючное животное');

-- 
-- Dumping data for table commands
--
INSERT INTO commands VALUES
(1, 'Стоять'),
(2, 'Сидеть'),
(3, 'Идти'),
(4, 'Лежать'),
(5, 'Голос');

-- 
-- Dumping data for table typeanimals
--
INSERT INTO typeanimals VALUES
(1, 'Кошка', 1),
(2, 'Собака', 1),
(3, 'Попугай', 1),
(4, 'Лошадь', 2),
(5, 'Верблюд', 2),
(6, 'Осел', 2);

-- 
-- Dumping data for table commandstype
--
INSERT INTO commandstype VALUES
(1, 1, NULL),
(1, 2, NULL),
(1, 3, NULL),
(1, 4, NULL),
(1, 5, 'Мяу-мяу!'),
(2, 1, NULL),
(2, 2, NULL),
(2, 3, NULL),
(2, 4, NULL),
(2, 5, 'Гав-гав!'),
(3, 1, NULL),
(3, 5, 'Пиу-пиу!'),
(4, 1, NULL),
(4, 3, NULL),
(4, 5, 'Иго-го!'),
(5, 1, NULL),
(5, 3, NULL),
(5, 4, NULL),
(5, 5, 'Бууу!'),
(6, 1, NULL),
(6, 3, NULL),
(6, 4, NULL),
(6, 5, 'Иа-иа!');

-- 
-- Dumping data for table animals
--
INSERT INTO animals VALUES
(1, 'Мурка', 1, '2020-10-01'),
(2, 'Джек', 2, '2021-07-01'),
(3, 'Кока', 3, '2022-05-01'),
(4, 'Буян', 4, '2022-05-01'),
(5, 'Пустынник', 5, '2020-05-01'),
(6, 'Самвел', 6, '2020-05-01');

-- 
-- Restore previous SQL mode
-- 
/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;

-- 
-- Enable foreign keys
-- 
/*!40014 SET FOREIGN_KEY_CHECKS = @OLD_FOREIGN_KEY_CHECKS */;